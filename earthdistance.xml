<!-- Dernière modification
     le       $Date$
     par      $Author$
     révision $Revision$ -->

<sect1 id="earthdistance">
 <title>earthdistance</title>

 <indexterm zone="earthdistance">
  <primary>earthdistance</primary>
 </indexterm>

 <para>
  Le module <filename>earthdistance</filename> fournit deux approches
  différentes pour calculer les distances sur la surface de la Terre. Celle
  décrit en premier dépend du package <filename>cube</filename> (qui
  <emphasis>doit</emphasis> être installé avant
  <filename>earthdistance</filename> pour que ce dernier puisse être installé).
  La seconde est basée sur le type de données interne <type>point</type> en
  utilisant longitude et latitude pour les coordonnées.
 </para>

 <para>
  Dans ce module, la Terre est supposée parfaitement sphérique (si c'est
  trop inexact pour vous, passez au projet <application><ulink
  url="http://www.postgis.org/">PostGIS</ulink></application>
  project.)
 </para>

 <sect2>
  <title>Distances sur Terre en se basant sur des cubes</title>

  <para>
   Les données sont stockées dans des cubes qui sont des points (les coins
   sont identiques) en utilisant trois coordonnées représentant la distance
   x, y et z du centre de la Terre. Un domaine <type>earth</type> sur
   <type>cube</type> est fourni. Il inclut des contraintes de vérification pour
   que la valeur respecte ces restrictions et est raisonnablement proche de la
   surface réelle de la Terre.
  </para>

  <para>
   Le rayon de la Terre est obtenu à partir de la fonction
   <function>earth()</function>. Il est donné en mètre mais, en modification
   cette fonction, vous pouvez modifier le module pour qu'il utilise d'autres
   unités, ou pour utiliser une valeur différente, mais plus appropriée, du
   rayon.
  </para>

  <para>
   Ce paquet a des applications pour les bases de données en astronomie. Les
   astronomes voudront certainement modifier <function>earth()</function> pour
   qu'elle renvoie un rayon de <literal>180/pi()</literal> de façon à ce que
   les distances soient en degrés.
  </para>

  <para>
   Les fonctions sont fournies pour accepter latitude et longitude en entrée
   et en sortie (en degrés) ainsi que pour calculer la distance entre deux
   points et pour facilement spécifier une boîte globale utilisable pour les
   recherches par index.
  </para>

  <para>
   Les fonctions suivantes sont fournies&nbsp;:
  </para>

  <table id="earthdistance-cube-functions">
   <title>Fonctions earthdistance basées sur des cube</title>
   <tgroup cols="3">
    <thead>
     <row>
      <entry>Fonction</entry>
      <entry>Retour</entry>
      <entry>Description</entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry><function>earth()</function></entry>
      <entry><type>float8</type></entry>
      <entry>Renvoie le rayon estimé de la Terre.</entry>
     </row>
     <row>
      <entry><function>sec_to_gc(float8)</function></entry>
      <entry><type>float8</type></entry>
      <entry>Convertit la distance en ligne directe (secant) entre deux
       points sur la surface de la Terre en une distane en cercle entre
       eux.
      </entry>
     </row>
     <row>
      <entry><function>gc_to_sec(float8)</function></entry>
      <entry><type>float8</type></entry>
      <entry>Convertit la distance en cercle entre deux points sur la surface
       de la Terre en une distance en ligne droite (secant).
      </entry>
     </row>
     <row>
      <entry><function>ll_to_earth(float8, float8)</function></entry>
      <entry><type>earth</type></entry>
      <entry>Renvoie l'emplacement d'un point sur la surface de la Terre étant
       donné sa latitude (argument 1) et sa longitude (argument 2) en degrés.
      </entry>
     </row>
     <row>
      <entry><function>latitude(earth)</function></entry>
      <entry><type>float8</type></entry>
      <entry>Renvoie la latitude en degrés d'un point sur la surface de la
       Terre.
      </entry>
     </row>
     <row>
      <entry><function>longitude(earth)</function></entry>
      <entry><type>float8</type></entry>
      <entry>Renvoie la longitude en degrés d'un point sur la surface de la
       Terre.
      </entry>
     </row>
     <row>
      <entry><function>earth_distance(earth, earth)</function></entry>
      <entry><type>float8</type></entry>
      <entry>Renvoie la distance en cercle entre deux points sur la surface
       de la Terre.
      </entry>
     </row>
     <row>
      <entry><function>earth_box(earth, float8)</function></entry>
      <entry><type>cube</type></entry>
      <entry>Renvoie une boîte convenable pour une recherche par index en
       utilisant l'opérateur <literal>@&gt;</literal> du type cube pour les
       points dans une distance cercle donnée d'un emplacement. Certains
       points de cette boîte sont plus loin que la distance cercle spécifiée
       en partant de l'emplacement. Donc, une deuxième vérification utilisant
       <function>earth_distance</function> doit être inclus dans la requête.
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>

 </sect2>

 <sect2>
  <title>Distances sur Terre basées sur des points</title>

  <para>
   La seconde partie du module se base sur la représentation des emplacements
   sur Terre en tant que valeurs de type <type>point</type>, pour lesquelles
   le premier composant est pris pour représenter la longitude en degrés, et
   le second composant est pris pour représenter la latitude en degrés. Les
   points sont pris en tant que (longitude, latitude) et non pas vice-versa
   car la longitude est plus proche de l'idée intuitive de l'axe X et la
   latitude celle de l'axe Y.
  </para>

  <para>
   Un seul opérateur est fourni&nbsp;:
  </para>

  <table id="earthdistance-point-operators">
   <title>Opérateurs earthdistance basés sur les points</title>
   <tgroup cols="3">
    <thead>
     <row>
      <entry>Opérateur</entry>
      <entry>Retour</entry>
      <entry>Description</entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry><type>point</type> <literal>&lt;@&gt;</literal> <type>point</type></entry>
      <entry><type>float8</type></entry>
      <entry>Donne la distance en miles entre deux points sur la surface de
       la Terre.
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>

  <para>
   Notez que contrairement à la partie basée sur <type>cube</type> dans ce
   module, les unités ne sont pas modifiables ici&nbsp;: modifier la fonction
   <function>earth()</function> n'affecte pas les résultats de cet opérateur.
  </para>

  <para>
   Un inconvénient de la représentation longitude/latitude est que vous avez
   besoin de faire attention aux conditions particulières près des pôles et
   près de +/- 180 degrés de longitude. La représentation basée sur les
   <type>cube</type> évite ces discontinuités.
  </para>

 </sect2>

</sect1>
