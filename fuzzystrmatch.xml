<!-- SAS : 20071220, PG83b4 -->

<sect1 id="fuzzystrmatch">
 <title>fuzzystrmatch</title>
 
 <para>
  Cette section décrit le module fuzzystrmatch. Ce module fournit diverse
  fonctions qui permettent de déterminer les similarités et la distance entre
  des chaînes.
 </para>

 <sect2>
  <title>Soundex</title>
  <para>
   Le système Soundex est une méthode qui permet d'associer un même code à des
   noms (ou des mots) dont la prononciation est proche. Elle a été
   utilisée à l'origine par le «&nbsp;United States Census&nbsp;» en 1880,
   1900 et 1910, mais a peu d'utilité en dehors des noms anglais (ou plutôt
   de la prononciation anglaise des noms). Ce n'est pas un outil linguistique.
  </para>
  <para>
   Lors de la comparaison de deux valeurs soundex pour déterminer la similarité,
   la fonction de différence définit la proximité de correspondance
   sur une échelle de zéro à quatre, zéro signifiant aucune correspondance et
   quatre une correspondance exacte.
  </para>
  <para>
   Quelques exemples d'utilisation&nbsp;:
  </para>
  <programlisting><![CDATA[
SELECT soundex('hello world!');

SELECT soundex('Anne'), soundex('Ann'), difference('Anne', 'Ann');
SELECT soundex('Anne'), soundex('Andrew'), difference('Anne', 'Andrew');
SELECT soundex('Anne'), soundex('Margaret'), difference('Anne', 'Margaret');

CREATE TABLE s (nm text);

INSERT INTO s VALUES ('john');
INSERT INTO s VALUES ('joan');
INSERT INTO s VALUES ('wobbly');
INSERT INTO s VALUES ('jack');

SELECT * FROM s WHERE soundex(nm) = soundex('john');

SELECT a.nm, b.nm FROM s a, s b WHERE soundex(a.nm) = soundex(b.nm) AND a.oid <> b.oid;

CREATE FUNCTION text_sx_eq(text, text) RETURNS boolean AS
'select soundex($1) = soundex($2)'
LANGUAGE SQL;

CREATE FUNCTION text_sx_lt(text, text) RETURNS boolean AS
'select soundex($1) < soundex($2)'
LANGUAGE SQL;

CREATE FUNCTION text_sx_gt(text, text) RETURNS boolean AS
'select soundex($1) > soundex($2)'
LANGUAGE SQL;

CREATE FUNCTION text_sx_le(text, text) RETURNS boolean AS
'select soundex($1) <= soundex($2)'
LANGUAGE SQL;

CREATE FUNCTION text_sx_ge(text, text) RETURNS boolean AS
'select soundex($1) >= soundex($2)'
LANGUAGE SQL;

CREATE FUNCTION text_sx_ne(text, text) RETURNS boolean AS
'select soundex($1) <> soundex($2)'
LANGUAGE SQL;

DROP OPERATOR #= (text, text);

CREATE OPERATOR #= (leftarg=text, rightarg=text, procedure=text_sx_eq, commutator = #=);

SELECT * FROM s WHERE text_sx_eq(nm, 'john');

SELECT * FROM s WHERE s.nm #= 'john';

SELECT * FROM s WHERE difference(s.nm, 'john') > 2;
  ]]></programlisting>
 </sect2>

 <sect2>
  <title>levenshtein</title>
  <para>
   Cette fonction calcule la distance de levenshtein entre deux chaînes&nbsp;:
  </para>
  <programlisting>
   int levenshtein(text source, text target)
  </programlisting>
  <para>
   La <literal>source</literal> et la cible (<literal>target</literal>)
   sont des chaînes quelconques non NULL de 255 caractères au maximum.
  </para>
  <para>
   Exemple&nbsp;:
  </para>
  <programlisting>
   SELECT levenshtein('GUMBO','GAMBOL');
  </programlisting>
 </sect2>

 <sect2>
  <title>metaphone</title>
  <para>
   Cette fonction calcule et renvoie le code metaphone d'une chaîne en
   entrée&nbsp;:
  </para>
  <programlisting>
   text metaphone(text source, int max_output_length)
  </programlisting>
  <para>
   <literal>source</literal> doit être une chaîne non NULL de
   255 caractères au maximum. <literal>max_output_length</literal> fixe la longueur
   maximale du code metaphone résultant&nbsp;; s'il est plus long, la sortie
   est tronquée à cette taille.
  </para>
  <para>Exemple</para>
  <programlisting>
   SELECT metaphone('GUMBO',4);
  </programlisting>
 </sect2>

</sect1>
