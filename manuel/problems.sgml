<!--
$Header: /var/lib/cvs/pgsql-fr/sgml/problems.sgml,v 1.6.2.4 2005/07/03 21:47:58 guillaume Exp $
-->

<sect1 id="bogue-reporting">
 <title>Lignes de conduite pour les rapports de bogues</title>

 <para>
  Lorsque vous trouvez un bogue dans <productname>PostgreSQL</productname>,
  il faut que nous le sachions. Vos rapports de bogues sont essentiels pour
  rendre <productname>PostgreSQL</productname> plus fiable. En effet
  même la plus grande attention ne pas garantir que chaque
  partie de <productname>PostgreSQL</productname> fonctionnera sur toute
  plates-forme en toute circonstance.
 </para>

 <para>
  Les suggestions suivantes ont pour but de vous former à la saisie d'un
  rapport de bogue qui pourra ensuite être géré de façon efficace. Il n'est
  pas obligatoire de les suivre mais tout le monde en tirera profit.
 </para>

 <para>
  Nous ne promettons pas de corriger tous les bogues immédiatement. Si
  le bogue est évident, critique ou affecte un grand nombre d'utilisateurs, il
  y a de grandes chances pour que quelqu'un s'en charge. Il peut aussi arriver
  que nous vous demandions d'utiliser une version plus récente pour voir si le
  bogue est toujours présent. Nous pourrions aussi décider que le bogue ne peut
  être corrigé avant qu'une réécriture massive, que nous planifierions, ne
  soit réalisée. Peut-être encore cette correction est-elle trop difficile et
  des choses plus importantes sont prévues. Si vous avez un besoin d'aide immédiat,
  il vous faudra considérer la souscription d'un contrat de support commercial.
 </para>

 <sect2>
  <title>Identifier les bogues</title>

  <para>
   Avant de rapporter un bogue, merci de lire et re-lire la documentation pour
   vérifier que ce que vous essayez de faire est réellement prévu. Si
   la documentation n'est pas claire sur ce point, faites également remonter cette
   information&nbsp;; c'est un bogue dans la documentation. S'il s'avère que le
   programme se déroule différemment de ce qu'indique la documentation, c'est un bogue.
   Ceci peut inclure les circonstances suivantes, sans s'y limiter&nbsp;:

   <itemizedlist>
    <listitem>
     <para>
      Un programme se termine avec un signal fatal ou un message d'erreur du
      système d'exploitation indiquant un problème dans le programme.
      (Un contre-exemple pourrait être le message <quote>disk full</quote>,
      disque plein, car vous devez le régler vous-même.)
     </para>
    </listitem>

    <listitem>
     <para>
      Un programme produit une sortie erronnée pour une entrée donnée.
     </para>
    </listitem>

    <listitem>
     <para>
      Un programme refuse d'accepter une entrée valide (c'est-à-dire telle que
      définie dans la documentation).
     </para>
    </listitem>

    <listitem>
     <para>
      Un programme accepte une entrée invalide sans information ou message
      d'erreur. Il est toutefois possible que ce que vous estimez être une entrée
      invalide soit en fait notre idée d'une extension ou d'une compatibilité avec les
      pratiques traditionnelles.
     </para>
    </listitem>

    <listitem>
     <para>
      <productname>PostgreSQL</productname> échoue à la compilation, à la
      construction ou à l'installation suivant les instructions des
      plateformes supportées.
     </para>
    </listitem>
   </itemizedlist>

   Ici, <quote>programme</quote> fait référence à un exécutable, pas uniquement
   au moteur du serveur.
  </para>

  <para>
   Une lenteur ou une accaparation des ressources n'est pas nécessairement un
   bogue. Lisez la documentation ou demandez sur une des listes de discussion
   de l'aide pour optimiser vos applications. Ne pas se
   conformer au standard <acronym>SQL</acronym> n'est pas nécessairement un
   bogue sauf si une telle conformité est indiquée explicitement.
  </para>

  <para>
   Avant de continuer, vérifiez sur la liste des tâches, ainsi que dans
   la FAQ, pour voir si votre bogue n'est pas déjà connu. Si vous n'arrivez pas à
   décoder les informations sur la liste des tâches, écrivez un rapport.
   Le minimum que nous puissions faire est de rendre cette liste plus claire.
  </para>
 </sect2>

 <sect2>
  <title>Que rapporter&nbsp;?</title>
  <para>
   Le point le plus important lors d'un rapport de bogues est de se souvenir de
   rapporter tous les faits et seulement les faits. Ne spéculez pas sur ce que vous
   pensez être le dysfonctionnement, sur ce qu'<quote>il semblait faire</quote> ou
   sur la partie du programme qui contient une erreur. Si vous n'êtes pas familier de
   l'implémentation, vous vous tromperez probablement et vous ne nous aiderez
   pas. Même si vous aviez raison, des explications complètes sont un bon
   complément mais elles ne doivent pas se substituer aux faits. Si nous décidons de
   corriger le bogue, nous devons toujours le reproduire nous-même. Rapporter
   les faits stricts est relativement simple (vous pouvez probablement les
   copier/coller à partir de l'écran) mais, trop souvent, des détails importants
   sont oubliés parce que quelqu'un a pensé qu'ils n'avaient pas d'importance ou
   que le rapport serait compris.
  </para>

  <para>
   Les éléments suivants devraient être fournis avec chaque rapport de
   bogue&nbsp;:

   <itemizedlist>
    <listitem>
     <para>
      La séquence exacte des étapes nécessaires pour reproduire le problème
      <emphasis>à partir du lancement du programme</emphasis>. Ceci doit se
      suffire&nbsp;; si la sortie doit dépendre des données contenues dans
      les tables, il n'est pas suffisant d'envoyer une simple instruction
      <command>SELECT</command> sans les commandes
      <command>CREATE TABLE</command> et <command>INSERT</command>
      qui ont précédé. Nous n'avons pas le temps de comprendre le schéma de votre
      base de données et si nous sommes supposés créer nos propres données, nous
      allons probablement passer à côté du problème.
     </para>

     <para>
      Le meilleur format de jeu de test pour les problèmes relatif au SQL est un
      fichier qui peut être lancé via l'interface
      <application>psql</application> et qui montrera le problème.
      (Assurez-vous de ne rien avoir dans votre fichier de lancement
      <filename>~/.psqlrc</filename>.) Un bon début pour ce fichier est
      d'utiliser <application>pg_dump</application> pour récupérer les
      déclarations des tables ainsi que les données nécessaires pour mettre en
      place la scène. Il ne reste plus qu'à ajouter la requête posant problème.
      Vous êtes encouragé à minimiser la taille de votre exemple mais ce n'est
      pas une obligation. Si le bogue est reproductible, nous le trouverons de
      toute façon.
     </para>

     <para>
      Si votre application utilise une autre interface client, telle que
      <application>PHP</>, essayez alors d'isoler les requêtes
      posant problème. Nous n'allons certainement pas mettre en place un serveur web
      pour reproduire votre problème. Dans tous les cas, n'oubliez pas de fournir
      les fichiers d'entrée exacts&nbsp;; n'essayez pas de deviner
      que le problème se pose pour les <quote>gros fichiers</quote> ou pour les
      <quote>bases de données de moyenne taille</quote>, etc. car cette
      information est trop inexacte, voire subjective, pour être utile.
     </para>
    </listitem>

    <listitem>
     <para>
      La sortie que vous obtenez. Merci de ne pas dire que cela <quote>ne
      fonctionne pas</quote> ou s'est <quote>arrêté brutalement</quote>. S'il
      existe un message d'erreur, montrez-le, même si vous ne le comprenez pas.
      Si le programme se termine avec une erreur du système d'exploitation,
      dites-le. Même si le résultat de votre test est un arrêt brutal du
      programme ou un autre soucis évident, il pourrait ne pas survenir sur
      notre plateforme. Le plus simple est de copier directement la sortie du
      terminal quand cela est possible.
     </para>
     <note>
      <para>
       Si vous rapportez un message d'erreur, merci d'obtenir la forme la plus
       verbeuse de ce message. Avec <application>psql</>, exécutez avant tout <literal>\set
       VERBOSITY verbose</>. Si vous récupérez le message des traces
       du serveur, positionnez la variable d'exécution
       <varname>log_error_verbosity</> à <literal>verbose</> pour que tous les
       détails soient tracés.
      </para>
     </note>
     <note>
      <para>
       Dans le cas d'erreurs fatales, le message d'erreur rapporté par le client
       pourrait ne pas contenir toutes les informations disponibles. Jetez aussi un
       &oelig;il aux traces du serveur de la base de données. Si vous ne
       conservez pas les traces de votre serveur, c'est peut-être le bon moment pour
       commencer à le faire.
      </para>
     </note>
    </listitem>

    <listitem>
     <para>
      La sortie que vous attendez est une information très importante à donner.
      Si vous écrivez uniquement <quote>Cette commande m'a donné cette
      réponse.</quote> ou <quote>Ce n'est pas ce que j'attendais.</quote>,
      nous pourrions le lancer nous-même, analyser la sortie et penser que tout
      est correct car cela correspond exactement à ce que nous attendions. Nous
      ne devrions pas avoir à passer du temps pour décoder la sémantique exacte
      de vos commandes. En particulier, ne vous contentez pas de dire que
      <quote>Ce n'est pas ce que SQL spécifie/Oracle fait.</quote> Rechercher le
      comportement correct à partir de <acronym>SQL</acronym> n'est pas
      amusant et nous ne connaissons pas le comportement de tous les autres
      serveurs de base de données relationnels (Si votre problème est un arrêt
      brutal du serveur, vous pouvez évidemment omettre cet élément.)
     </para>
    </listitem>

    <listitem>
     <para>
      Toutes les options en ligne de commande ainsi que les autres options de
      lancement incluant les variables d'environnement ou les fichiers de
      configuration que vous avez modifié. Encore une fois, soyez précis. Si
      vous utilisez une distribution pré-empaquetée qui lance le serveur au
      démarrage, vous devriez essayer de retrouver ce que cette distribution
      fait.
     </para>
    </listitem>

    <listitem>
     <para>
      Tout ce que vous avez fait différement des instructions d'installation.
     </para>
    </listitem>

    <listitem>
     <para>
      La version de <productname>PostgreSQL</productname>. Vous pouvez lancer la
      commande <literal>SELECT version();</literal> pour trouver la version du
      serveur sur lequel vous êtes connecté. La plupart des exécutables dispose
      aussi d'une option <option>--version</option>&nbsp;;
      <literal>postmaster --version</literal> et <literal>psql --version</literal>
      au moins devraient fonctionner.
      Si la fonction ou les options n'existent pas, alors votre version est bien
      trop ancienne et vous devez la mettre à jour. Si vous avez lancé une version
      préparée sous forme de paquets, tels que des RPM, dites-le en incluant la
      sous-version que le paquet aurait éventuellement. Si vous travaillez avec
      une version CVS, mentionnez-le en indiquant la date et l'heure de la capture CVS.
     </para>

     <para>
      Si votre version est antérieure à &version;, nous allons certainement
      vous demander de la mettre à jour. Il existe des tonnes de corrections à
      chaque mise à jour, ce qui explique pourquoi nous faisons de nouvelles
      versions.
     </para>
     <para>
     </para>
    </listitem>

    <listitem>
     <para>
      Informations sur la plate-forme. Ceci inclut le nom du noyau et sa version,
      bibliothèque C, processeur, mémoires. Dans la plupart des cas, il est
      suffisant de rapporter le vendeur et la version mais ne supposez pas que
      tout le monde sait ce que <quote>Debian</quote> contient ou que tout le
      monde utilise des Pentiums. Si vous avez des problèmes à l'installation,
      les informations concernant le compilateurs, make, etc. seront aussi nécessaires.
     </para>
    </listitem>
   </itemizedlist>

   Ne vous inquiétez pas si votre rapport de bogue devient assez long. C'est un fait.
   Il est préférable de tout rapporter la première fois plutôt que de nous obliger à vous
   demander tous les faits. D'un autre côté, si vos fichiers en entrée sont trop
   gros, il est préférable de demander si quelqu'un souhaite s'y plonger.
  </para>

  <para>
   Ne passez pas tout votre temps à vous demander quelles modifications apporter
   aux données en entrée pour faire disparaître le problème. Ceci ne nous aidera
   probablement pas à le résoudre. S'il se trouve que le bogue ne puisse pas être
   corrigé instantanément, vous aurez toujours le temps de chercher et de partager vos trouvailles.
   Encore une fois, ne perdez pas votre temps à deviner pourquoi le
   bogue existe. Nous trouverons cela assez rapidement.
  </para>

  <para>
   Lors de la rédaction d'un rapport de bogue, merci de choisir une terminologie
   qui ne laisse pas de place à l'ambiguité. Le paquet logiciel dans sa totalité est
   appelé <quote>PostgreSQL</quote>, parfois <quote>Postgres</quote> en abrégé.
   Si vous parlez spécifiquement du serveur, mentionnez-le mais ne dites pas
   seulement <quote>PostgreSQL a planté</quote>. Un arrêt brutal d'un seul processus
   serveur est assez différent de l'arrêt brutal du
   <quote>postmaster</> père&nbsp;; merci de ne pas dire que <quote>le postmaster
   a planté</> lorsque vous voulez dire qu'un seul processus s'est arrêté, et
   vice versa. De plus, les programmes clients tels que l'interface interactive
   <quote><application>psql</application></quote> sont complètement séparés du
   moteur. Essayez d'être précis sur la provenance du problème&nbsp;: client ou
   serveur.
  </para>
 </sect2>

 <sect2>
  <title>Où rapporter des bogues&nbsp;?</title>

  <para>
   En général, envoyez vos rapports de bogue à la liste de discussion des
   rapports de bogue (<email>pgsql-bugs@postgresql.org</email>).
   Il est recommandé d'utiliser un sujet descriptif pour votre courriel, pourquoi
   pas une partie du message d'erreur.
  </para>

  <para> 
   Une autre méthode consiste à remplir le formulaire web disponible sur le
   site web du projet
   <ulink url="http://www.postgresql.org/">http://www.postgresql.org/</ulink>.
   Saisir un rapport de bogue de cette façon implique son envoi à la
   liste de discussion <email>pgsql-bugs@postgresql.org</email>.
  </para>

  <para>
   Si votre rapport de bogue a des implications sur la sécurité et que vous
   préfériez qu'il ne soit pas immédiatement visible dans les archives
   publiques, ne l'envoyez pas sur <literal>pgsql-bugs</literal>. Les problèmes
   de sécurité peuvent être rapportés en privé sur
   <email>security@postgresql.org</email>.
  </para>

  <para>
   N'envoyez pas de rapports de bogue aux listes de discussion d'utilisateurs,
   comme <email>pgsql-sql@postgresql.org</email> ou
   <email>pgsql-general@postgresql.org</email>.
   Ces listes de discussion servent à répondre aux questions des utilisateurs et
   les abonnés ne souhaitent pas, en général, recevoir de rapports de bogues. Plus important,
   il y a peu de chance qu'ils les corrigent.
  </para>

  <para>
   De même, n'envoyez <emphasis>pas</emphasis> vos rapports de bogue à la liste
   de discussion des développeurs <email>pgsql-hackers@postgresql.org</email>.
   Cette liste sert aux discussions concernant le développement de
   <productname>PostgreSQL</productname> et il serait bon de conserver les
   rapports de bogue séparément. Nous pouvons toujours décider de discuter de votre
   rapport de bogue sur <literal>pgsql-hackers</literal> si le problème
   nécessite plus de personnes pour s'en occuper.
  </para>

  <para>
   Si vous avez un problème avec la documentation, le meilleur endroit pour le
   rapporter est la liste de discussion pour la documentation
   <email>pgsql-docs@postgresql.org</email>. Soyez précis sur la partie de la
   documentation qui vous déplaît.
  </para>
 
  <para>
   Si votre bogue concerne un problème de portabilité sur une plate-forme non
   supportée, envoyez un courrier électronique à
   <email>pgsql-hackers@postgresql.org</email>, pour que nous puissions travailler
   sur le portage de <productname>PostgreSQL</productname> sur votre plate-forme.
  </para>

  <note>
   <para>
    Du fait du grand nombre de pourriels (spam) qui circulent, toutes les
    adresses de courrier électronique ci-dessus appartiennent à des listes
    de discussion fermées. C'est-à-dire que vous devez être abonné pour être
    autorisé à y envoyer un courriel. Néanmoins, vous n'avez pas besoin de vous
    abonner pour utiliser le formulaire web de rapports de bogue. Si vous
    souhaitez envoyer des courriels mais ne pas recevoir le trafic de la liste,
    vous pouvez vous abonner et configurer l'option <literal>nomail</>.
    Pour plus d'information, envoyez un courriel à
    <email>majordomo@postgresql.org</email>
    avec le seul mot <literal>help</> dans le corps du message.
   </para>
  </note>
 </sect2>
</sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode:sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"./reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:("/usr/lib/sgml/catalog")
sgml-local-ecat-files:nil
End:
-->
