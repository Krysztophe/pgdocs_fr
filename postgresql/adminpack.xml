<?xml version="1.0" encoding="UTF-8"?>
<sect1 id="adminpack" xreflabel="adminpack">
 <title>adminpack</title>

 <indexterm zone="adminpack">
  <primary>adminpack</primary>
 </indexterm>

 <para>
  L'<filename>adminpack</filename> fournit un certain nombre de fonctions de
  support que <application>pgAdmin</application> ou d'autres outils de gestion
  et d'administration peuvent utiliser pour fournir des fonctionnalités
  supplémentaires, comme la gestion à distance de journaux applicatifs.
  L'utilisation de toutes ces fonctions est restreinte aux superutilisateurs.
 </para>

 <para>
  Les fonctions indiquées dans <xref linkend="functions-adminpack-table"/>
  fournissent un accès en écriture aux fichiers de la machine hébergeant le
  serveur. (Voir aussi les fonctions dans <xref linkend="functions-admin-
  genfile"/>, qui fournissent un accès en lecture seule.) Seuls les fichiers
  stockés dans les répertoire de l'instance sont accessibles, même si un
  chemin relatif ou absolu est autorisé.
 </para>

 <table id="functions-adminpack-table">
  <title>Fonctions <filename>adminpack</filename></title>
  <tgroup cols="3">
   <thead>
    <row><entry>Nom</entry> <entry>Type de retour</entry> <entry>Description</entry>
    </row>
   </thead>

   <tbody>
    <row>
     <entry><function>pg_catalog.pg_file_write(filename text, data text, append boolean)</function></entry>
     <entry><type>bigint</type></entry>
     <entry>
      Écrit ou ajoute dans un fichier texte
     </entry>
    </row>
    <row>
     <entry><function>pg_catalog.pg_file_rename(oldname text, newname text <optional>, archivename text</optional>)</function></entry>
     <entry><type>boolean</type></entry>
     <entry>
      Renomme un fichier
     </entry>
    </row>
    <row>
     <entry><function>pg_catalog.pg_file_unlink(filename text)</function></entry>
     <entry><type>boolean</type></entry>
     <entry>
      Supprime un fichier
     </entry>
    </row>
    <row>
     <entry><function>pg_catalog.pg_logdir_ls()</function></entry>
     <entry><type>setof record</type></entry>
     <entry>
      Liste les journaux applicatifs dans le répertoire ciblé par
      <varname>log_directory</varname>
     </entry>
    </row>
   </tbody>
  </tgroup>
 </table>

 <indexterm>
  <primary>pg_file_write</primary>
 </indexterm>
 <para>
  <function>pg_file_write</function> écrit les <parameter>data</parameter>
  spécifiées dans le fichier nommé par <parameter>filename</parameter>. Si
  <parameter>append</parameter> est false, le fichier ne doit pas déjà
  exister. Si <parameter>append</parameter> est true, le fichier peut déjà
  exister, et les données y seront ajoutées si c'est le cas. Renvoit le nombre
  d'octets écrits.
 </para>

 <indexterm>
  <primary>pg_file_rename</primary>
 </indexterm>
 <para>
  <function>pg_file_rename</function> renomme un fichier. Si
  <parameter>archivename</parameter> est omis ou NULL, il renomme simplement
  <parameter>oldname</parameter> en <parameter>newname</parameter> (ce dernier
  ne doit pas déjà exister). Si <parameter>archivename</parameter> est fourni,
  il commence par renommer <parameter>newname</parameter> en
  <parameter>archivename</parameter> (qui ne doit pas déjà exister), puis il
  renomme <parameter>oldname</parameter> en <parameter>newname</parameter>.
  Dans le cas d'échec lors de la deuxième étape de renommage, il essaiera de
  renommer <parameter>archivename</parameter> en
  <parameter>newname</parameter> avant de renvoyer l'erreur. Renvoie true en
  cas de success, false si un des fichiers sources n'est pas présent ou
  modifiables. Tous les autres cas renvoient des erreurs.
 </para>

 <indexterm>
  <primary>pg_file_unlink</primary>
 </indexterm>
 <para>
  <function>pg_file_unlink</function> supprime le fichier indiqué. Renvoie
  true en cas de succès, false si le fichier indiqué n'est pas présent ou si
  l'appel à <function>unlink()</function> échoue. Tous les autres cas
  renvoient des erreurs.
 </para>

 <indexterm>
  <primary>pg_logdir_ls</primary>
 </indexterm>
 <para>
  <function>pg_logdir_ls</function> renvoie les horodatages de démarrage et
  les noms de fichiers pour tous les journaux applicatifs compris dans le
  répertoire <xref linkend="guc-log-directory"/>. Le paramètre <xref
  linkend="guc-log-filename"/> doit avoir sa configuration par défaut
  (<literal>postgresql-%Y-%m-%d_%H%M%S.log</literal>) pour utiliser cette
  fonction.
 </para>

 <para>
  Les fonctions indiquées dans <xref linkend="functions-adminpack-deprecated-
  table"/> sont obsolètes et ne devraient plus être utilisées dans de
  nouvelles applications. Utilisez à la place celles indiquées dans <xref
  linkend="functions-admin-signal-table"/> et dans <xref linkend="functions-
  admin-genfile"/>.  Ces fonctions sont fournies dans
  <filename>adminpack</filename> uniquement pour des raisons de compatibilité
  pour les anciennes versions de <application>pgAdmin</application>.
 </para>

 <table id="functions-adminpack-deprecated-table">
  <title>Fonctions obsolètes de <filename>adminpack</filename></title>
  <tgroup cols="3">
   <thead>
    <row><entry>Nom</entry> <entry>Type du retour</entry> <entry>Description</entry>
    </row>
   </thead>

   <tbody>
    <row>
     <entry><function>pg_catalog.pg_file_read(filename text, offset bigint, nbytes bigint)</function></entry>
     <entry><type>text</type></entry>
     <entry>
      Autre nom pour <function>pg_read_file()</function>
     </entry>
    </row>
    <row>
     <entry><function>pg_catalog.pg_file_length(filename text)</function></entry>
     <entry><type>bigint</type></entry>
     <entry>
      Identique à la colonne <structfield>size</structfield> renvoyée par la
      fonction <function>pg_stat_file()</function>
     </entry>
    </row>
    <row>
     <entry><function>pg_catalog.pg_logfile_rotate()</function></entry>
     <entry><type>integer</type></entry>
     <entry>
      Autre nom pour <function>pg_rotate_logfile()</function>, mais notez
      qu'elle renvoie un entier 0 ou 1 à la place d'un booléen
     </entry>
    </row>
   </tbody>
  </tgroup>
 </table>

</sect1>
