<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
$Header: /var/lib/cvs/pgsql-fr/sgml/ref/create_table_as.sgml,v 1.10 2005/04/06 22:38:52 guillaume Exp $
PostgreSQL documentation
-->

<refentry id="sql-createtableas">
 <refmeta>
  <refentrytitle id="sql-createtableas-title">CREATE TABLE AS</refentrytitle>
  <refmiscinfo>SQL - Instructions du langage</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>CREATE TABLE AS</refname>
  <refpurpose>définit une nouvelle table à partir des résultats d'une
   requête</refpurpose>
 </refnamediv>

 <indexterm zone="sql-createtableas">
  <primary>CREATE TABLE AS</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>
CREATE [ [ GLOBAL | LOCAL ] { TEMPORARY | TEMP } ] TABLE <replaceable>nom_table</replaceable>
    [ (<replaceable>nom_colonne</replaceable> [, ...] ) ] [ [ WITH | WITHOUT ] OIDS ]
    AS <replaceable>requête</replaceable>
</synopsis>
 </refsynopsisdiv>
  
 <refsect1>
  <title>Description</title>

  <para>
   <command>CREATE TABLE AS</command> crée une table et la remplit avec des
   données récupérées par une commande <command>SELECT</command> ou un
   <command>EXECUTE</command> qui lance une commande préparée
   <command>SELECT</command>. Les colonnes de table ont les noms et les types de
   données associés avec les colonnes en sortie du <command>SELECT</command>
   (sauf que vous pouvez surcharger les noms de colonne en donnant une liste
   explicite des nouveaux noms de colonnes).
  </para>

  <para>
   <command>CREATE TABLE AS</command> possède des similitudes avec la création 
   de vue mais son comportement est assez différente : elle crée une nouvelle
   table et évalue la requête juste une fois pour remplir la nouvelle table
   initialement. La nouvelle table ne tracera pas les changements suivants pour
   les tables source de la requête. À l'opposé, une vue ré-évalue son
   instruction <command>SELECT</command> à chaque fois qu'elle est appelée.
  </para>
 </refsect1>

 <refsect1>
  <title>Paramètres</title>

  <variablelist>
   <varlistentry>
    <term><literal>GLOBAL</literal> or <literal>LOCAL</literal></term>
    <listitem>
     <para>
      Ignoré. Conservé pour la compatibilité. Référez-vous à <xref
      linkend="sql-createtable" endterm="sql-createtable-title"/> pour plus
      de renseignements.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>TEMPORARY</literal> ou <literal>TEMP</literal></term>
    <listitem>
     <para>
      Si spécifié, la table est créée comme une table temporaire.
      Référez-vous à <xref linkend="sql-createtable"
      endterm="sql-createtable-title"/> pour plus de renseignements.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable>nom_table</replaceable></term>
    <listitem>
     <para>
      Le nom de la table à créer (pouvant être qualifié avec le nom du schéma).
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable>nom_colonne</replaceable></term>
    <listitem>
     <para>
      Le nom d'une colonne dans une nouvelle table. Si les noms de colonnes ne
      sont pas fournis, ils sont pris des noms de colonnes en sortie de la
      requête. Si la table est créée à partir d'une commande
      <command>EXECUTE</command>, une liste de noms de colonnes peut ne pas
      être spécifiée.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>WITH OIDS</literal></term>
    <term><literal>WITHOUT OIDS</literal></term>
     <listitem>
      <para>
       Cette clause optionnelle spécifie si la table créée par <command>CREATE
       TABLE AS</command> devrait inclure OIDs. Si aucune forme de cette clause
       n'est spécifiée, la valeur du paramètre de configuration <xref
       linkend="guc-default-with-oids"/> est utilisée.
      </para>
     </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable>requête</replaceable></term>
    <listitem>
     <para>
      Une instruction de requête (c'est-à-dire une commande
      <command>SELECT</command> ou une commande <command>EXECUTE</command> qui
      exécute une commande <command>SELECT</command> préparée). Référez-vous
      à <xref linkend="sql-select" endterm="sql-select-title"/> ou <xref
      linkend="sql-execute" endterm="sql-execute-title"/>, respectivement pour
      une description de la syntaxe autorisée.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>

 <refsect1>
  <title>Notes</title>

  <para>
   Cette commande est équivalente fonctionnellement à <xref
   linkend="sql-selectinto" endterm="sql-selectinto-title"/> mais elle est
   préférée car il y a moins de risque de confusion avec les autres utilisations
   de la syntaxe <command>SELECT ... INTO</command>. De plus, <command>CREATE
   TABLE AS</command> offre un ensemble de fonctionnalités plus
   important que celles proposées par <command>SELECT INTO</command>.
  </para>

  <para>
   Avant <productname>PostgreSQL</productname> 8.0, <command>CREATE
   TABLE AS</command> incluait toujours les OIDs dans la table qu'elle créait.
   À partir de <productname>PostgresSQL</productname> 8.0, la commande
   <command>CREATE TABLE AS</command> autorise l'utilisateur à spécifier
   explicitement les OID à inclure. Si la présence de OID n'est pas spécifiée
   explicitement, la variable de configuration <xref
   linkend="guc-default-with-oids"/> est utilisée. À partir de
   <productname>PostgreSQL</productname> 8.1, cette variable vaut false par
   défaut, donc le comportement par défaut n'est pas identique aux versions
   précédant la 8.0. Les applications nécessitant des OID dans la table créée
   par <command>CREATE TABLE AS</command> devraient indiquer explicitement
   <literal>WITH OIDS</literal> pour s'assurer d'un bon comportement.
  </para>
 </refsect1>

 <refsect1>
  <title>Exemples</title>

  <para>
   Créer une nouvelle table <literal>films_recent</literal> consistant des
   entrées récentes de la table <literal>films</literal> :

<programlisting>
CREATE TABLE films_recent AS
  SELECT * FROM films WHERE date_prod &gt;= '2002-01-01';
</programlisting>
  </para>
 </refsect1>


 <refsect1>
  <title>Compatibilité</title>

  <para>
   <command>CREATE TABLE AS</command> est conforme au standard
   <acronym>SQL</acronym>, avec les exceptions suivantes&nbsp;:

   <itemizedlist spacing="compact">
    <listitem>
     <para>
      Le standard requiert des parenthèses autour de la clause de la
      sous-requête&nbsp;; dans <productname>PostgreSQL</productname>, ces
      parenthèses sont optionnelles.
     </para>
    </listitem>

    <listitem>
     <para>
      Le standard définit une clause <literal>ON COMMIT</literal>&nbsp;; elle
      n'est pas encore implémentée par <productname>PostgreSQL</productname>.
     </para>
    </listitem>

    <listitem>
     <para>
      Le standard définit une clause <literal>WITH [ NO ] DATA</literal>&nbsp;;
      elle n'est pas encore implémentée par <productname>PostgreSQL</productname>.
      Le comportement de <productname>PostgreSQL</productname> est équivalent au cas
      <literal>WITH DATA</literal> du standard.
     </para>
    </listitem>

    <listitem>
     <para>
      <literal>WITH/WITHOUT OIDS</literal> est une extension de
      <productname>PostgreSQL</productname>.
     </para>
    </listitem>

    <listitem>
     <para>
      <productname>PostgreSQL</productname> gère les tables temporaires d'une façon assez
      différente du standard, voir
      <xref linkend="sql-createtable" endterm="sql-createtable-title"/>
      pour plus de renseignements.
     </para>
    </listitem>
   </itemizedlist>
  </para>
 </refsect1>

 <refsect1>
  <title>Voir aussi</title>

  <simplelist type="inline">
   <member><xref linkend="sql-createtable" endterm="sql-createtable-title"/></member>
   <member><xref linkend="sql-execute" endterm="sql-execute-title"/></member>
   <member><xref linkend="sql-select" endterm="sql-select-title"/></member>
   <member><xref linkend="sql-selectinto" endterm="sql-selectinto-title"/></member>
  </simplelist>
 </refsect1>
 
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->
