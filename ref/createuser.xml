<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
$Header: /var/lib/cvs/pgsql-fr/sgml/ref/createuser.sgml,v 1.9 2005/09/15 07:03:26 guillaume Exp $
PostgreSQL documentation
-->
<!-- SAS 20060618 : Relecture initiale -->

<refentry id="app-createuser">
 <refmeta>
  <refentrytitle id="app-createuser-title"><application>createuser</application></refentrytitle>
  <manvolnum>1</manvolnum>
  <refmiscinfo>Application</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>createuser</refname>
  <refpurpose>Définir un nouveau compte utilisateur
  <productname>PostgreSQL</productname></refpurpose>
 </refnamediv>

 <refsynopsisdiv>
  <cmdsynopsis>
   <command>createuser</command>
   <arg rep="repeat"><replaceable>option</replaceable></arg>
   <arg><replaceable>nom_utilisateur</replaceable></arg>
  </cmdsynopsis>
 </refsynopsisdiv>
  

 <refsect1>
  <title>Description</title>
  <indexterm zone="app-createuser">
   <primary>createuser</primary>
  </indexterm>

  <para>
   <application>createuser</application> crée un nouvel utilisateur
   <productname>PostgreSQL</productname> (ou, plus précisément, un rôle). Seuls
   les superutilisateurs et les utilisateurs disposant du droit
   <literal>CREATEROLE</literal> peuvent créer de nouveaux utilisateurs.
   <application>createuser</application> ne peut de ce fait être invoqué 
   que par un utilisateur pouvant se connecter en superutilisateur
   ou en utilisateur ayant le droit <literal>CREATEROLE</literal>.
  </para>

  <para>
   Pour créer un superutilisateur, il est impératif de se connecter en
   superutilisateur&nbsp;; la simple connexion en utilisateur
   disposant du droit <literal>CREATEROLE</literal> n'est pas suffisante.
   Être superutilisateur implique la capacité d'outrepasser toutes les
   vérifications de droits d'accès à la base de données&nbsp;; les 
   privilèges de superutilisateur ne peuvent pas être accordés à la légère.
  </para>

  <para>
   <application>createuser</application> est un enrobage de la commande
   <acronym>SQL</acronym>
   <xref linkend="sql-createrole" endterm="sql-createrole-title"/>.
   Il n'y a pas de différence réelle entre la
   création d'utilisateurs par cet outil ou au travers d'autres méthodes
   d'accès au serveur.
  </para>

 </refsect1>


 <refsect1>
  <title>Options</title>

  <para>
   <application>createuser</application> accepte les arguments suivant en ligne de
   commande&nbsp;

    <variablelist>
     <varlistentry>
      <term><replaceable class="parameter">nomutilisateur</replaceable></term>
      <listitem>
       <para>
		Le nom de l'utilisateur	à créer. Ce nom doit être différent
		de tout rôle de l'instance courante de <productname>PostgreSQL</productname>.
       </para>
      </listitem>
     </varlistentry>  

     <varlistentry>
      <term><option>-s</option></term>
      <term><option>--superuser</option></term>
      <listitem>
       <para>
		Le nouvel utilisateur a les privilèges superutilisateur.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-S</option></term>
      <term><option>--no-superuser</option></term>
      <listitem>
       <para>
		Le nouvel utilisateur n'a pas les privilèges superutilisateur.
		Comportement par défaut.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-d</option></term>
      <term><option>--createdb</option></term>
      <listitem>
       <para>
		Le nouvel utilisateur est autorisé à créer des bases de données.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-D</option></term>
      <term><option>--no-createdb</option></term>
      <listitem>
       <para>
		Le nouvel utilisateur n'est pas autorisé à créer des bases de données.
		Comportement par défaut.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-r</option></term>
      <term><option>--createrole</option></term>
      <listitem>
       <para>
        Le nouvel utilisateur est autorisé à créer de nouveaux rôles
        (il possède le privilège <literal>CREATEROLE</literal>).
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-R</option></term>
      <term><option>--no-createrole</option></term>
      <listitem>
       <para>
        Le nouvel utilisateur n'est pas autorisé à créer de nouveaux rôles.
		Comportement par défaut.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-l</option></term>
      <term><option>--login</option></term>
      <listitem>
       <para>
        Le nouvel utilisateur est autorisé à se connecter (son nom
        peut être utilisé comme identifiant initial de session).
        Comportement par défaut.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-L</option></term>
      <term><option>--no-login</option></term>
      <listitem>
       <para>
        Le nouvel utilisateur n'est pas autorisé à se connecter.
        (Un rôle sans droit de connexion est toujours utile pour
        gérer les droits de la base de données.)
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-i</option></term>
      <term><option>--inherit</option></term>
      <listitem>
       <para>
        Le nouveau rôle hérite automatiquement des droits des rôles dont il
        est membre. Comportement par défaut.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-I</option></term>
      <term><option>--no-inherit</option></term>
      <listitem>
       <para>
        Le nouveau rôle n'hérite pas automatiquement des droits des rôles dont
        il est membre.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-c <replaceable class="parameter">number</replaceable></option></term>
      <term><option>--connection-limit <replaceable class="parameter">number</replaceable></option></term>
      <listitem>
       <para>
        Configure le nombre maximum de connexions simultanées pour le nouvel
        utilisateur. Par défaut, il n'y a pas de limite.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-P</option></term>
      <term><option>--pwprompt</option></term>
      <listitem>
       <para>
		L'utilisation de cette option impose à <application>createuser</application>
		d'afficher une invite pour la saisie du mot de passe du nouvel utilisateur.
		Cela n'a pas d'utilité si l'authentification par mot de	passe n'est pas envisagée.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-E</option></term>
      <term><option>--encrypted</option></term>
      <listitem>
       <para>
        Le mot de passe de l'utilisateur est stocké chiffré dans la base.
        Si cette option n'est pas précisée, la gestion par défaut des mots de passe
		est utilisée.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-N</option></term>
      <term><option>--unencrypted</option></term>
      <listitem>
       <para>
        Le mot de passe de l'utilisateur n'est pas stocké chiffré.
		Si cette option n'est pas précisée, la gestion par défaut des mots de passe
		est utilisée.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-e</option></term>
      <term><option>--echo</option></term>
      <listitem>
       <para>
        Les commandes engendréee par <application>createuser</application> et envoyées
		au serveur sont affichées.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-q</option></term>
      <term><option>--quiet</option></term>
      <listitem>
       <para>
        Aucune réponse n'est affichée.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
  </para>

  <para>
   Le nom, ou toute autre information manquante non fournie sur la ligne de commande,
   est automatiquement demandée.
  </para>

  <para>
   <application>createuser</application> accepte aussi les arguments suivant en
   ligne de commande pour les paramètres de connexion&nbsp;:
    
   <variablelist>
     <varlistentry>
      <term><option>-h <replaceable	class="parameter">hôte</replaceable></option></term>
      <term><option>--host <replaceable	class="parameter">hôte</replaceable></option></term>
      <listitem>
       <para>
		Le nom de l'hôte sur lequel le serveur est en
		cours d'exécution. Si la valeur commence avec un slash (/), elle est
		utilisée comme répertoire du socket de domaine Unix.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-p <replaceable class="parameter">port</replaceable></option></term>
      <term><option>--port <replaceable class="parameter">port</replaceable></option></term>
      <listitem>
       <para>
		Le port TCP ou l'extension du fichier socket de domaine Unix sur lequel
		le serveur attend des connexions.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-U <replaceable class="parameter">nomutilisateur</replaceable></option></term>
      <term><option>--username <replaceable class="parameter">nomutilisateur</replaceable></option></term>
      <listitem>
       <para>
        Nom de l'utilisateur utilisé pour la connexion (pas celui à créer).
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-W</option></term>
      <term><option>--password</option></term>
      <listitem>
       <para>
        Un mot de passe est obligatoirement demandé (pour la connexion au serveur,
		pas celui du nouvel utilisateur).
       </para>
      </listitem>
     </varlistentry>
   </variablelist>
  </para>
 </refsect1>


 <refsect1>
  <title>Environnement</title>

  <variablelist>
   <varlistentry>
    <term><envar>PGHOST</envar></term>
    <term><envar>PGPORT</envar></term>
    <term><envar>PGUSER</envar></term>

    <listitem>
     <para>
      Paramètres de connexion par défaut
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   Cet outil, comme la plupart des autres outils <productname>PostgreSQL</productname>,
   utilise aussi les variables d'environnement supportées par la bibliothèque
   <application>libpq</application> (voir <xref linkend="libpq-envars"/>).
  </para>

 </refsect1>


 <refsect1>
  <title>Diagnostiques</title>

  <para>
   En cas de problèmes, on peut consulter
   <xref linkend="sql-createrole" endterm="sql-createrole-title"/> et
   <xref linkend="app-psql"/> qui fournissent des informations 
   sur les problèmes potentiels et les messages d'erreur. Le
   serveur de la base de données doit être en cours d'exécution sur l'hôte
   cible. De plus, tout paramétrage de connexion par défaut et toute variable
   d'environnement utilisée par le client de la bibliothèque
   <application>libpq</application> s'applique.
  </para>

 </refsect1>


 <refsect1>
  <title>Exemples</title>

   <para>
    Créer un utilisateur <literal>joe</literal> sur le serveur de bases de
    données par défaut&nbsp;:
<screen><prompt>$ </prompt><userinput>createuser joe</userinput>
<computeroutput>Shall the new role be a superuser? (y/n) </computeroutput><userinput>n</userinput>
<computeroutput>Shall the new role be allowed to create databases? (y/n) </computeroutput><userinput>n</userinput>
<computeroutput>Shall the new role be allowed to create more new roles? (y/n) </computeroutput><userinput>n</userinput>
<computeroutput>CREATE USER</computeroutput>
</screen>
   </para>

   <para>
    Créer le même utilisateur, <literal>joe</literal>, sur le
    serveur <literal>eden</literal>, port 5000, sans interaction, avec affichage
    de la commande sous-jacente&nbsp;:
<screen><prompt>$ </prompt><userinput>createuser -h eden -p 5000 -S -D -R -e joe</userinput>
<computeroutput>CREATE ROLE joe NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT LOGIN;</computeroutput>
<computeroutput>CREATE ROLE</computeroutput>
</screen>
   </para>

   <para>
    Créer l'utilisateur <literal>joe</literal>,
    superutilisateur, et lui affecter immédiatement un mot de passe&nbsp;:
<screen><prompt>$ </prompt><userinput>createuser -P -s -e joe</userinput>
<computeroutput>Enter password for new role: </computeroutput><userinput>xyzzy</userinput>
<computeroutput>Enter it again: </computeroutput><userinput>xyzzy</userinput>
<computeroutput>CREATE ROLE joe PASSWORD 'xyzzy' SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN;</computeroutput>
<computeroutput>CREATE ROLE</computeroutput>
</screen>
    Dans l'exemple ci-dessus, le nouveau mot de passe n'est pas
    affiché lorsqu'il est saisi. Il ne l'est ici que pour plus de clareté.
    Néanmoins, le mot de passe <emphasis>apparaît</emphasis> lors de l'affichage de
	la commande engendrée &mdash; il est préférable de ne pas utiliser l'option
	<literal>-e</literal> lors de l'affectation d'un mot de passe si quelqu'un
	peut voir l'écran.
   </para>
 </refsect1>


 <refsect1>
  <title>Voir aussi</title>

  <simplelist type="inline">
   <member><xref linkend="app-dropuser"/></member>
   <member><xref linkend="sql-createrole" endterm="sql-createrole-title"/></member>
  </simplelist>
 </refsect1>

</refentry>
