<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
$Header: /var/lib/cvs/pgsql-fr/sgml/ref/set.sgml,v 1.8 2005/04/22 06:38:58 guillaume Exp $
PostgreSQL documentation
-->
<!-- SAS 20060308 pour la relecture -->

<refentry id="sql-set">
 <refmeta>
  <refentrytitle id="sql-set-title">SET</refentrytitle>
  <refmiscinfo>SQL - Instructions du langage</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>SET</refname>
  <refpurpose>change un paramètre d'exécution</refpurpose>
 </refnamediv>

 <refsynopsisdiv>
<synopsis>SET [ SESSION | LOCAL ] <replaceable class="parameter">paramètre_configuration</replaceable> { TO | = } { <replaceable class="parameter">valeur</replaceable> | '<replaceable class="parameter">valeur</replaceable>' | DEFAULT }
SET [ SESSION | LOCAL ] TIME ZONE { <replaceable class="parameter">fuseau-horaire</replaceable> | LOCAL | DEFAULT }
</synopsis>
 </refsynopsisdiv>
 
 <refsect1>
  <title>Description</title>
  <indexterm zone="sql-set">
   <primary>SET</primary>
  </indexterm>


  <para>
   La commande <command>SET</command> permet de modifier les paramètres
   d'exécution. Un grand nombre de paramètres d'exécution, listés dans
   <xref linkend="runtime-config"/>, peuvent être modifiés à la volée
   avec la commande <command>SET</command>.
   <command>SET</command> ne modifie que les paramètres utilisés par 
   la session courante.
  </para>
  <para>
   Certains paramètres ne peuvent être modifiés que par le superutilisateur,
   d'autres ne peuvent plus être changés après le démarrage
   du serveur ou de la session.
  </para>

  <para>
   Si <command>SET</command> ou <command>SET SESSION</command> sont
   utilisés dans une transaction abandonnée par la suite, les effets de la
   commande <command>SET</command> disparaissent dès l'annulation de la
   transaction. Lorsque la transaction englobant la commande est validée, les
   effets de la commande persistent jusqu'à la fin de la session, à moins
   qu'ils ne soient annulés par une autre commande <command>SET</command>.
  </para>

  <para>
   Les effets de <command>SET LOCAL</command> ne durent que jusqu'à la fin 
   de la transaction en cours, qu'elle soit validée ou non.
   Dans le cas particulier d'une commande <command>SET</command> suivie
   par <command>SET LOCAL</command> dans une même transaction, la valeur de
   <command>SET LOCAL</command> est utilisée jusqu'à la fin de la transaction,
   et celle de <command>SET</command> prend effet ensuite (si la 
   transaction est validée).
  </para>

  <para>
   The effects of <command>SET</command> or <command>SET LOCAL</command> are
   also canceled by rolling back to a savepoint that is earlier than the
   command.
  </para>

  <para>
   If <command>SET LOCAL</command> is used within a function that has a
   <literal>SET</literal> option for the same variable (see
   <xref linkend="sql-createfunction" endterm="sql-createfunction-title"/>),
   the effects of the <command>SET LOCAL</command> command disappear at
   function exit; that is, the value in effect when the function was called is
   restored anyway.  This allows <command>SET LOCAL</command> to be used for
   dynamic or repeated changes of a parameter within a function, while still
   having the convenience of using the <literal>SET</literal> option to save and
   restore the caller's value.  However, a regular <command>SET</command> command
   overrides any surrounding function's <literal>SET</literal> option; its effects
   will persist unless rolled back.
  </para>

  <note>
   <para>
    In <productname>PostgreSQL</productname> versions 8.0 through 8.2,
    the effects of a <command>SET LOCAL</command> would be canceled by
    releasing an earlier savepoint, or by successful exit from a
    <application>PL/pgSQL</application> exception block.  This behavior
    has been changed because it was deemed unintuitive.
   </para>
  </note>
 </refsect1>

 <refsect1>
  <title>Paramètres</title>

  <variablelist>
   <varlistentry>
    <term><literal>SESSION</literal></term>
    <listitem>
     <para>
      Indique que la commande prend effet pour la session courante.
      C'est la valeur par défaut lorsque <literal>SESSION</literal> et
      <literal>LOCAL</literal> sont omis.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>LOCAL</literal></term>
    <listitem>
     <para>
      Indique que la commande n'est effective que pour la transaction
      courante. Après <command>COMMIT</command> ou <command>ROLLBACK</command>,
      la valeur de session redevient effective.
      Une commande <command>SET LOCAL</command> est sans effet si
      elle est exécutée en dehors d'un bloc <command>BEGIN</command> car la 
      transaction prend immédiatement fin.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">paramètre_configuration</replaceable></term>
    <listitem>
     <para>
      Nom d'un paramètre ajustable pendant l'exécution.
      La liste des paramètres disponibles est documentée dans 
      <xref linkend="runtime-config"/> et ci-dessous.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">valeur</replaceable></term>
    <listitem>
     <para>
      Nouvelle valeur du paramètre. Les valeurs peuvent être indiquées
      sous forme de constantes de chaîne, d'identifiants, de nombres ou
      de listes de ceux-ci, séparées par des virgules, as appropriate for the particular parameter.
      <literal>DEFAULT</literal> peut être utilisé pour repositionné le
      paramètre à sa valeur par défaut (that is, whatever
      value it would have had if no <command>SET</command> had been executed
      in the current session).
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   En plus des paramètres de configuration documentés dans <xref
   linkend="runtime-config"/>, il y en a quelques autres qui ne peuvent
   être initialisés qu'avec la commande <command>SET</command> ou 
   ont une syntaxe spéciale.

   <variablelist>
    <varlistentry>
     <term><literal>NAMES</literal></term>
     <listitem>
      <para>
       <literal>SET NAMES <replaceable>valeur</replaceable></literal> est un équivalent de
       <literal>SET client_encoding TO <replaceable>valeur</replaceable></literal>.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><literal>SEED</literal></term>
     <listitem>
      <para>
       Précise la valeur interne du générateur de nombres aléatoires
       (la fonction <function>random</function>).
       Les valeurs autorisées sont des nombres à virgule flottante entre
       0 et 1, qui sont ensuite multipliés par 2<superscript>31</superscript>-1.
      </para>

      <para>
       Le générateur de nombres aléatoires peut aussi être initialisé en
       appelant la fonction <function>setseed</function>&nbsp;:
<programlisting>SELECT setseed(<replaceable>valeur</replaceable>);
</programlisting>
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><literal>TIME ZONE</literal></term>
     <listitem>
      <para>
       <literal>SET TIME ZONE <replaceable>valeur</replaceable></literal> est équivalent à
       <literal>SET timezone TO <replaceable>valeur</replaceable></literal>.
       La syntaxe <literal>SET TIME ZONE</literal> permet d'utiliser une
       syntaxe spéciale pour indiquer le fuseau horaire.
       Quelques exemples de valeurs valides&nbsp;:

       <variablelist>
        <varlistentry>
         <term><literal>'PST8PDT'</literal></term>
         <listitem>
          <para>
           Le fuseau horaire de Berkeley, Californie.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><literal>'Europe/Rome'</literal></term>
         <listitem>
          <para>
           Le fuseau horaire de l'Italie.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><literal>-7</literal></term>
         <listitem>
          <para>
           Le fuseau horaire situé 7 heures à l'ouest de l'UTC (équivalent 
           à PDT). Les valeurs positives sont à l'est de l'UTC.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><literal>INTERVAL '-08:00' HOUR TO MINUTE</literal></term>
         <listitem>
          <para>
           Le fuseau horaire situé 8 heures à l'ouest de l'UTC (équivalent 
           à PST).
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><literal>LOCAL</literal></term>
         <term><literal>DEFAULT</literal></term>
         <listitem>
          <para>
           Utilise le fuseau horaire local (that is, the
           server's default value of <varname>timezone</varname>; if this
           has not been explicitly set anywhere, it will be the zone that
           the server's operating system defaults to).
          </para>
         </listitem>
        </varlistentry>
       </variablelist>

       Voir <xref linkend="datatype-timezones"/> pour de plus amples
       informations sur les fuseaux horaires.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
 </refsect1>

 <refsect1>
  <title>Notes</title>

  <para>
   La fonction <function>set_config</function> propose des fonctionnalités
   équivalentes. Voir <xref linkend="functions-admin"/>.
   Also, it is possible to UPDATE the
   <link linkend="view-pg-settings"><structname>pg_settings</structname></link>
   system view to perform the equivalent of <command>SET</command>.
  </para>
 </refsect1>
 
 <refsect1>
  <title>Exemples</title>

  <para>
   Mettre à jour le chemin de recherche&nbsp;:
<programlisting>SET search_path TO my_schema, public;
</programlisting>
  </para>

  <para>
   Utiliser le style de date traditionnel 
   <productname>POSTGRES</productname> avec comme convention de saisie
   <quote>les jours avant les mois</quote>&nbsp;:
<screen>SET datestyle TO postgres, dmy;
</screen>
  </para>

  <para>
   Utiliser le fuseau horaire de Berkeley, Californie&nbsp;:
<screen>SET TIME ZONE 'PST8PDT';
</screen>
  </para>

  <para>
   Utiliser le fuseau horaire de l'Italie&nbsp;:
<screen>SET TIME ZONE 'Europe/Rome';
</screen>
  </para>
 </refsect1>

 <refsect1>
  <title>Compatibilité</title>

  <para>
   <literal>SET TIME ZONE</literal> étend la syntaxe définie dans le standard
   SQL. Le standard ne permet que des fuseaux horaires numériques alors que
   <productname>PostgreSQL</productname> est plus souple dans les syntaxes 
   acceptées.
   Toutes les autres fonctionnalités de <literal>SET</literal> sont des 
   extensions de <productname>PostgreSQL</productname>.
  </para>
 </refsect1>

 <refsect1>
  <title>Voir aussi</title>

  <simplelist type="inline">
   <member><xref linkend="sql-reset" endterm="sql-reset-title"/></member>
   <member><xref linkend="sql-show" endterm="sql-show-title"/></member>
  </simplelist>
 </refsect1>
</refentry>
