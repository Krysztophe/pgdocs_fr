<!--
$Header: /var/lib/cvs/pgsql-fr/sgml/ref/revoke.sgml,v 1.7 2004/12/21 23:02:58 guillaume Exp $
PostgreSQL documentation
-->

<refentry id="SQL-REVOKE">
 <refmeta>
  <refentrytitle id="sql-revoke-title">REVOKE</refentrytitle>
  <refmiscinfo>SQL - Instructions du langage </refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>REVOKE</refname>
  <refpurpose>supprime les droits d'accès</refpurpose>
 </refnamediv>

 <indexterm zone="sql-revoke">
  <primary>REVOKE</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>
REVOKE [ GRANT OPTION FOR ]
    { { SELECT | INSERT | UPDATE | DELETE | RULE | REFERENCES | TRIGGER }
    [,...] | ALL [ PRIVILEGES ] }
    ON [ TABLE ] <replaceable class="PARAMETER">nom_table</replaceable> [, ...]
    FROM { <replaceable class="PARAMETER">nom_utilisateur</replaceable> | GROUP
    <replaceable class="PARAMETER">nom_groupe</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { { CREATE | TEMPORARY | TEMP } [,...] | ALL [ PRIVILEGES ] }
    ON DATABASE <replaceable>nom_db</replaceable> [, ...]
    FROM { <replaceable class="PARAMETER">nom_utilisateur</replaceable> | GROUP
    <replaceable class="PARAMETER">nom_groupe</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { EXECUTE | ALL [ PRIVILEGES ] }
    ON FUNCTION <replaceable>nom_fonction</replaceable>
([<replaceable>type</replaceable>, ...]) [, ...]
    FROM { <replaceable class="PARAMETER">nom_utilisateur</replaceable> | GROUP
    <replaceable class="PARAMETER">nom_groupe</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { USAGE | ALL [ PRIVILEGES ] }
    ON LANGUAGE <replaceable>nom_langage</replaceable> [, ...]
    FROM { <replaceable class="PARAMETER">nom_utilisateur</replaceable> | GROUP
    <replaceable class="PARAMETER">nom_groupe</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { { CREATE | USAGE } [,...] | ALL [ PRIVILEGES ] }
    ON SCHEMA <replaceable>nom_schéma</replaceable> [, ...]
    FROM { <replaceable class="PARAMETER">nom_utilisateur</replaceable> | GROUP
    <replaceable class="PARAMETER">nom_groupe</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]
</synopsis>
 </refsynopsisdiv>

 <refsect1 id="SQL-REVOKE-description">
  <title>Description</title>

  <para>
   La commande <command>REVOKE</command> retire des droits précédemment
   attribués à un ou plusieurs utilisateurs ou groupes d'utilisateurs.
   Le mot clé <literal>PUBLIC</literal> fait référence au groupe implicitement
   défini de tous les utilisateurs.
  </para>

  <para>
   Voir la description de la commande <xref linkend="sql-grant"
   endterm="sql-grant-title"> pour connaître la signification des types de
   privilèges.
  </para>

  <para>
   Notez qu'un utilisateur possède la somme des droits qui lui ont été donnés
   directement, des droits qui ont été donnés à un groupe dont il est membre
   et des droits donnés à <literal>PUBLIC</literal>.
   Du coup, par exemple, retirer les droits de <literal>SELECT</> à 
   <literal>PUBLIC</literal> ne veut pas nécessairement dire que plus personne
   n'a le droit de faire de <literal>SELECT</> sur l'objet: ceux qui en avaient
   obtenu le droit directement ou via un groupe l'ont toujours.
  </para>

  <para>
   Si <literal>GRANT OPTION FOR</literal> est précisé, seul l'option
   de transmission de droit (grant option) est supprimée, pas le
   droit lui même.
  </para>

  <para>
   Si un utilisateur détient un privilège avec le droit de le transmettre,
   et qu'il l'a transmis à d'autres utilisateurs, alors les droits de 
   ceux-ci sont appelés des droits dépendants.
   Si les droits ou le droit de transmettre du premier utilisateur sont
   supprimés, et que des droits dépendants existent, alors ces droits 
   dépendants sont aussi supprimés si l'option <literal>CASCADE</literal>
   est utilisée, sinon la suppression de droits est refusée.
   Cette révocation récursive n'affecte que les privilèges qui avaient
   été attribués à travers une chaîne d'utilisateurs traçable jusqu'à 
   l'utilisateur qui subit la commande <literal>REVOKE</literal> command.
   Du coup, les utilisateurs affectés peuvent garder le droit s'il avait
   aussi été attribué via d'autres utilisateurs.
  </para>
 </refsect1>

 <refsect1 id="SQL-REVOKE-notes">
  <title>Notes</title>

  <para>
   Utilisez la commande <command>\z</command> de <xref linkend="app-psql">
   pour afficher les droits donnés sur des objets existants.
   Voir aussi <xref linkend="sql-grant" endterm="sql-grant-title">
   pour des informations sur le format.
  </para>

  <para>
   Un utilisateur ne peut révoquer que les droits qu'il a donné 
   directement. Si, par exemple, un utilisateur A a donné un droit
   et la possibilité de le transmettre à un utilisateur B, et que
   B à son tour l'a donné à C, alors A ne peut pas retirer directement
   le droit de C.
   A la place, il peut supprimer le droit de transmettre à B et utiliser
   l'option <literal>CASCADE</literal> pour que le droit soit 
   automatiquement supprimé à C.
  </para>

   <para>
    Si un super utilisateur choisit d'exécuter une commande <command>GRANT</> 
    ou <command>REVOKE</>, la command est exécutée comme si elle était
    lancée par le propriétaire de l'objet affecté.
    Comme tous les droits proviennent du propriétaire d'un objet (directement
    ou via une chaîne de transmissions de droits), un super utilisateur
    peut supprimer tous les droits sur un objet, mais cela peut nécessiter
    l'utilisation de <literal>CASCADE</literal> comme expliqué précédemment.
   </para>
 </refsect1>

 <refsect1 id="SQL-REVOKE-examples">
  <title>Exemples</title>

  <para>
   Enlève au groupe public le droit d'insérer des lignes dans la table
   <literal>films</literal>:

<programlisting>
REVOKE INSERT ON films FROM PUBLIC;
</programlisting>
  </para>

  <para>
   Supprime tous les droits de l'utilisateur <literal>manuel</literal> sur la
   vue <literal>kinds</literal>:

<programlisting>  
REVOKE ALL PRIVILEGES ON kinds FROM manuel;
</programlisting>
  </para>
 </refsect1>

 <refsect1 id="SQL-REVOKE-compatibility">
  <title>Compatibilité</title>

   <para>
    La note de compatibilité de la commande <xref linkend="sql-grant"
    endterm="sql-grant-title"> s'applique par analogie à 
    <command>REVOKE</command>. Le résumé de la syntaxe est:

<synopsis>
REVOKE [ GRANT OPTION FOR ] <replaceable
class="PARAMETER">privileges</replaceable>
    ON <replaceable class="parameter">object</replaceable> [ ( <replaceable
class="parameter">column</replaceable> [, ...] ) ]
    FROM { PUBLIC | <replaceable class="parameter">nom_utilisateur</replaceable>
[, ...] }
    { RESTRICT | CASCADE }
</synopsis>
    Le standard nécessite qu'une des options <literal>RESTRICT</literal> 
    ou <literal>CASCADE</literal> soit indiquée, mais 
    <productname>PostgreSQL</> utilise <literal>RESTRICT</literal> par
    défaut.
   </para>
 </refsect1>

 <refsect1>
  <title>Voir aussi</title>

  <simpara>
   <xref linkend="sql-grant" endterm="sql-grant-title">
  </simpara>
 </refsect1>

</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->

